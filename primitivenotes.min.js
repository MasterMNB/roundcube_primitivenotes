function add_note(){document.getElementById("upl").click()}function new_note(e){format=e?e:"",$.ajax({type:"POST",url:"plugins/primitivenotes/notes.php",data:{editHeader:"1",filename:""},success:function(e){$("#notescontentframe").contents().find("div#main_header").html(e)}}),$.ajax({type:"POST",url:"plugins/primitivenotes/notes.php",data:{editNote:"1",filename:"",format:format},success:function(e){$("#notescontentframe").contents().find("div#main_area").html(e)}})}function edit_note(){var e=window.frames.notescontentframe.document.getElementById("fname").value,t=e.substr(e.lastIndexOf(".")+1);$.ajax({type:"POST",url:"plugins/primitivenotes/notes.php",data:{editHeader:"1",filename:e},success:function(e){$("#notescontentframe").contents().find("div#main_header").html(e)}}),0<=["html","txt","md"].indexOf(t)&&$.ajax({type:"POST",url:"plugins/primitivenotes/notes.php",data:{editNote:"1",filename:e},success:function(e){$("#notescontentframe").contents().find("div#main_area").html(e)}})}function delete_note(){var e=window.frames.notescontentframe.document.getElementById("fname").value,t=window.frames.notescontentframe.document.getElementById("headerTitle").innerHTML,n=rcmail.gettext("note_del_note","primitivenotes").replace("%note%",t);if(e&&t){if(!confirm(n))return!1;$.ajax({url:"plugins/primitivenotes/notes.php",type:"post",data:{delNote:"1",mode:"delete",fileid:e},success:function(e){document.getElementById("notescontentframe").src="plugins/primitivenotes/notes.php"}})}}function send_note(){var e=window.frames.notescontentframe.document.getElementById("fname").value,t=e.substring(e.lastIndexOf(".")+1);-1<"html pdf jpg png md txt".split(" ").indexOf(t)?rcmail.goto_url("mail/compose",{_note_type:t,_note_filename:e},!0):alert(rcmail.gettext("note_inv_format","primitivenotes"))}window.rcmail&&rcmail.addEventListener("init",function(e){rcmail.register_command("newnote",new_note,!0),rcmail.register_command("editnote",edit_note,!0),rcmail.register_command("deletenote",delete_note,!0),rcmail.register_command("sendnote",send_note,!0),rcmail.register_command("addnote",add_note,!0),rcmail.register_command("htmlnote",new_note,!0),rcmail.register_command("mdnote",new_note,!0),rcmail.register_command("txtnote",new_note,!0)});