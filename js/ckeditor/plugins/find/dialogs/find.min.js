(function(){var e;function d(i){return i.type==CKEDITOR.NODE_TEXT&&i.getLength()>0&&(!e||!i.isReadOnly())}function f(i){return !(i.type==CKEDITOR.NODE_ELEMENT&&i.isBlockBoundary(CKEDITOR.tools.extend({},CKEDITOR.dtd.$empty,CKEDITOR.dtd.$nonEditable)))}var a=function(){return{textNode:this.textNode,offset:this.offset,character:this.textNode?this.textNode.getText().charAt(this.offset):null,hitMatchBoundary:this._.matchBoundary}};var g=["find","replace"],b=[["txtFindFind","txtFindReplace"],["txtFindCaseChk","txtReplaceCaseChk"],["txtFindWordChk","txtReplaceWordChk"],["txtFindCyclic","txtReplaceCyclic"]];function h(j){var o,q,n,p;o=j==="find"?1:0;q=1-o;var k,m=b.length;for(k=0;k<m;k++){n=this.getContentElement(g[o],b[k][o]);p=this.getContentElement(g[q],b[k][q]);p.setValue(n.getValue())}}function c(k,x){var p={attributes:{"data-cke-highlight":1},fullMatch:1,ignoreReadonly:1,childRule:function(){return 0}};var q=new CKEDITOR.style(CKEDITOR.tools.extend(p,k.config.find_highlight,true));function j(A,z){var B=this;var C=new CKEDITOR.dom.walker(A);C.guard=z?f:function(D){!f(D)&&(B._.matchBoundary=true)};C.evaluator=d;C.breakOnFalse=1;if(A.startContainer.type==CKEDITOR.NODE_TEXT){this.textNode=A.startContainer;this.offset=A.startOffset-1}this._={matchWord:z,walker:C,matchBoundary:false}}j.prototype={next:function(){return this.move()},back:function(){return this.move(true)},move:function(A){var z=this.textNode;if(z===null){return a.call(this)}this._.matchBoundary=false;if(z&&A&&this.offset>0){this.offset--;return a.call(this)}else{if(z&&this.offset<z.getLength()-1){this.offset++;return a.call(this)}else{z=null;while(!z){z=this._.walker[A?"previous":"next"].call(this._.walker);if(this._.matchWord&&!z||this._.walker._.end){break}}this.textNode=z;if(z){this.offset=A?z.getLength()-1:0}else{this.offset=0}}}return a.call(this)}};var i=function(z,A){this._={walker:z,cursors:[],rangeLength:A,highlightRange:null,isMatched:0}};i.prototype={toDomRange:function(){var C=k.createRange();var z=this._.cursors;if(z.length<1){var D=this._.walker.textNode;if(D){C.setStartAfter(D)}else{return null}}else{var A=z[0],B=z[z.length-1];C.setStart(A.textNode,A.offset);C.setEnd(B.textNode,B.offset+1)}return C},updateFromDomRange:function(A){var z,B=new j(A);this._.cursors=[];do{z=B.next();if(z.character){this._.cursors.push(z)}}while(z.character);this._.rangeLength=this._.cursors.length},setMatched:function(){this._.isMatched=true},clearMatched:function(){this._.isMatched=false},isMatched:function(){return this._.isMatched},highlight:function(){if(this._.cursors.length<1){return}if(this._.highlightRange){this.removeHighlight()}var B=this.toDomRange(),z=B.createBookmark();q.applyToRange(B,k);B.moveToBookmark(z);this._.highlightRange=B;var A=B.startContainer;if(A.type!=CKEDITOR.NODE_ELEMENT){A=A.getParent()}A.scrollIntoView();this.updateFromDomRange(B)},removeHighlight:function(){if(!this._.highlightRange){return}var z=this._.highlightRange.createBookmark();q.removeFromRange(this._.highlightRange,k);this._.highlightRange.moveToBookmark(z);this.updateFromDomRange(this._.highlightRange);this._.highlightRange=null},isReadOnly:function(){if(!this._.highlightRange){return 0}return this._.highlightRange.startContainer.isReadOnly()},moveBack:function(){var A=this._.walker.back(),z=this._.cursors;if(A.hitMatchBoundary){this._.cursors=z=[]}z.unshift(A);if(z.length>this._.rangeLength){z.pop()}return A},moveNext:function(){var A=this._.walker.next(),z=this._.cursors;if(A.hitMatchBoundary){this._.cursors=z=[]}z.push(A);if(z.length>this._.rangeLength){z.shift()}return A},getEndCharacter:function(){var z=this._.cursors;if(z.length<1){return null}return z[z.length-1].character},getNextCharacterRange:function(B){var A,C,z=this._.cursors;if((A=z[z.length-1])&&A.textNode){C=new j(m(A))}else{C=this._.walker}return new i(C,B)},getCursors:function(){return this._.cursors}};function m(z,A){var B=k.createRange();B.setStart(z.textNode,(A?z.offset:z.offset+1));B.setEndAt(k.editable(),CKEDITOR.POSITION_BEFORE_END);return B}function n(z){var A=k.createRange();A.setStartAt(k.editable(),CKEDITOR.POSITION_AFTER_START);A.setEnd(z.textNode,z.offset);return A}var u=0,s=1,t=2;var v=function(C,A){var B=[-1];if(A){C=C.toLowerCase()}for(var z=0;z<C.length;z++){B.push(B[z]+1);while(B[z+1]>0&&C.charAt(z)!=C.charAt(B[z+1]-1)){B[z+1]=B[B[z+1]-1]+1}}this._={overlap:B,state:0,ignoreCase:!!A,pattern:C}};v.prototype={feedCharacter:function(z){if(this._.ignoreCase){z=z.toLowerCase()}while(true){if(z==this._.pattern.charAt(this._.state)){this._.state++;if(this._.state==this._.pattern.length){this._.state=0;return t}return s}else{if(!this._.state){return u}else{this._.state=this._.overlap[this._.state]}}}},reset:function(){this._.state=0}};var y=/[.,"'?!;: \u0085\u00a0\u1680\u280e\u2028\u2029\u202f\u205f\u3000]/;var r=function(z){if(!z){return true}var A=z.charCodeAt(0);return(A>=9&&A<=13)||(A>=8192&&A<=8202)||y.test(z)};var l={searchRange:null,matchRange:null,find:function(K,F,J,G,E,B){if(!this.matchRange){this.matchRange=new i(new j(this.searchRange),K.length)}else{this.matchRange.removeHighlight();this.matchRange=this.matchRange.getNextCharacterRange(K.length)}var H=new v(K,!F),I=u,z="%";while(z!==null){this.matchRange.moveNext();while((z=this.matchRange.getEndCharacter())){I=H.feedCharacter(z);if(I==t){break}if(this.matchRange.moveNext().hitMatchBoundary){H.reset()}}if(I==t){if(J){var A=this.matchRange.getCursors(),N=A[A.length-1],C=A[0];var M=n(C),L=m(N);M.trim();L.trim();var D=new j(M,true),O=new j(L,true);if(!(r(D.back().character)&&r(O.next().character))){continue}}this.matchRange.setMatched();if(E!==false){this.matchRange.highlight()}return true}}this.matchRange.clearMatched();this.matchRange.removeHighlight();if(G&&!B){this.searchRange=o(1);this.matchRange=null;return arguments.callee.apply(this,Array.prototype.slice.call(arguments).concat([true]))}return false},replaceCounter:0,replace:function(z,H,G,C,F,D,B){e=1;var I=0,E=this.hasMatchOptionsChanged(H,C,F);if(this.matchRange&&this.matchRange.isMatched()&&!this.matchRange._.isReplaced&&!this.matchRange.isReadOnly()&&!E){this.matchRange.removeHighlight();var A=this.matchRange.toDomRange();var K=k.document.createText(G);if(!B){var J=k.getSelection();J.selectRanges([A]);k.fire("saveSnapshot")}A.deleteContents();A.insertNode(K);if(!B){J.selectRanges([A]);k.fire("saveSnapshot")}this.matchRange.updateFromDomRange(A);if(!B){this.matchRange.highlight()}this.matchRange._.isReplaced=true;this.replaceCounter++;I=1}else{if(E&&this.matchRange){this.matchRange.clearMatched();this.matchRange.removeHighlight();this.matchRange=null}I=this.find(H,C,F,D,!B)}e=0;return I},matchOptions:null,hasMatchOptionsChanged:function(D,A,C){var B=[D,A,C].join("."),z=this.matchOptions&&this.matchOptions!=B;this.matchOptions=B;return z}};function o(A){var C,D=k.getSelection(),B=D.getRanges()[0],z=k.editable();if(B&&!A){C=B.clone();C.collapse(true)}else{C=k.createRange();C.setStartAt(z,CKEDITOR.POSITION_AFTER_START)}C.setEndAt(z,CKEDITOR.POSITION_BEFORE_END);return C}var w=k.lang.find;return{title:w.title,resizable:CKEDITOR.DIALOG_RESIZE_NONE,minWidth:350,minHeight:170,buttons:[CKEDITOR.dialog.cancelButton(k,{label:k.lang.common.close})],contents:[{id:"find",label:w.find,title:w.find,accessKey:"",elements:[{type:"hbox",widths:["230px","90px"],children:[{type:"text",id:"txtFindFind",label:w.findWhat,isChanged:false,labelLayout:"horizontal",accessKey:"F"},{type:"button",id:"btnFind",align:"left",style:"width:100%",label:w.find,onClick:function(){var z=this.getDialog();if(!l.find(z.getValueOf("find","txtFindFind"),z.getValueOf("find","txtFindCaseChk"),z.getValueOf("find","txtFindWordChk"),z.getValueOf("find","txtFindCyclic"))){alert(w.notFoundMsg)}}}]},{type:"fieldset",className:"cke_dialog_find_fieldset",label:CKEDITOR.tools.htmlEncode(w.findOptions),style:"margin-top:29px",children:[{type:"vbox",padding:0,children:[{type:"checkbox",id:"txtFindCaseChk",isChanged:false,label:w.matchCase},{type:"checkbox",id:"txtFindWordChk",isChanged:false,label:w.matchWord},{type:"checkbox",id:"txtFindCyclic",isChanged:false,"default":true,label:w.matchCyclic}]}]}]},{id:"replace",label:w.replace,accessKey:"M",elements:[{type:"hbox",widths:["230px","90px"],children:[{type:"text",id:"txtFindReplace",label:w.findWhat,isChanged:false,labelLayout:"horizontal",accessKey:"F"},{type:"button",id:"btnFindReplace",align:"left",style:"width:100%",label:w.replace,onClick:function(){var z=this.getDialog();
if(!l.replace(z,z.getValueOf("replace","txtFindReplace"),z.getValueOf("replace","txtReplace"),z.getValueOf("replace","txtReplaceCaseChk"),z.getValueOf("replace","txtReplaceWordChk"),z.getValueOf("replace","txtReplaceCyclic"))){alert(w.notFoundMsg)}}}]},{type:"hbox",widths:["230px","90px"],children:[{type:"text",id:"txtReplace",label:w.replaceWith,isChanged:false,labelLayout:"horizontal",accessKey:"R"},{type:"button",id:"btnReplaceAll",align:"left",style:"width:100%",label:w.replaceAll,isChanged:false,onClick:function(){var z=this.getDialog();l.replaceCounter=0;l.searchRange=o(1);if(l.matchRange){l.matchRange.removeHighlight();l.matchRange=null}k.fire("saveSnapshot");while(l.replace(z,z.getValueOf("replace","txtFindReplace"),z.getValueOf("replace","txtReplace"),z.getValueOf("replace","txtReplaceCaseChk"),z.getValueOf("replace","txtReplaceWordChk"),false,true)){}if(l.replaceCounter){alert(w.replaceSuccessMsg.replace(/%1/,l.replaceCounter));k.fire("saveSnapshot")}else{alert(w.notFoundMsg)}}}]},{type:"fieldset",label:CKEDITOR.tools.htmlEncode(w.findOptions),children:[{type:"vbox",padding:0,children:[{type:"checkbox",id:"txtReplaceCaseChk",isChanged:false,label:w.matchCase},{type:"checkbox",id:"txtReplaceWordChk",isChanged:false,label:w.matchWord},{type:"checkbox",id:"txtReplaceCyclic",isChanged:false,"default":true,label:w.matchCyclic}]}]}]}],onLoad:function(){var z=this;var B,C;var A=0;this.on("hide",function(){A=0});this.on("show",function(){A=1});this.selectPage=CKEDITOR.tools.override(this.selectPage,function(D){return function(F){D.call(z,F);var E=z._.tabs[F];var H,G,I;G=F==="find"?"txtFindFind":"txtFindReplace";I=F==="find"?"txtFindWordChk":"txtReplaceWordChk";B=z.getContentElement(F,G);C=z.getContentElement(F,I);if(!E.initialized){H=CKEDITOR.document.getById(B._.inputId);E.initialized=true}if(A){h.call(this,F)}}})},onShow:function(){l.searchRange=o();var B=this.getParentEditor().getSelection().getSelectedText(),A=(x=="find"?"txtFindFind":"txtFindReplace");var z=this.getContentElement(x,A);z.setValue(B);z.select();this.selectPage(x);this[(x=="find"&&this._.editor.readOnly?"hide":"show")+"Page"]("replace")},onHide:function(){var z;if(l.matchRange&&l.matchRange.isMatched()){l.matchRange.removeHighlight();z=l.matchRange.toDomRange();if(z){k.getSelection().selectRanges([z])}k.focus()}delete l.matchRange},onFocus:function(){if(x=="replace"){return this.getContentElement("replace","txtFindReplace")}else{return this.getContentElement("find","txtFindFind")}}}}CKEDITOR.dialog.add("find",function(i){return c(i,"find")});CKEDITOR.dialog.add("replace",function(i){return c(i,"replace")})})();