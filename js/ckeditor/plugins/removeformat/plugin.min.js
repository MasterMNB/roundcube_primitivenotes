CKEDITOR.plugins.add("removeformat",{lang:"af,ar,az,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,es-mx,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,oc,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"removeformat",hidpi:true,init:function(a){a.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat);a.ui.addButton&&a.ui.addButton("RemoveFormat",{label:a.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}});CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(d){var o=d._.removeFormatRegex||(d._.removeFormatRegex=new RegExp("^(?:"+d.config.removeFormatTags.replace(/,/g,"|")+")$","i"));var m=d._.removeAttributes||(d._.removeAttributes=d.config.removeFormatAttributes.split(",")),f=CKEDITOR.plugins.removeformat.filter,l=d.getSelection().getRanges(),i=l.createIterator(),g=function(p){return p.type==CKEDITOR.NODE_ELEMENT},k;while((k=i.getNextRange())){if(!k.collapsed){k.enlarge(CKEDITOR.ENLARGE_ELEMENT)}var a=k.createBookmark(),n=a.startNode,e=a.endNode,c;var b=function(q){var r=d.elementPath(q),t=r.elements;for(var p=1,s;s=t[p];p++){if(s.equals(r.block)||s.equals(r.blockLimit)){break}if(o.test(s.getName())&&f(d,s)){q.breakParent(s)}}};b(n);if(e){b(e);c=n.getNextSourceNode(true,CKEDITOR.NODE_ELEMENT);while(c){if(c.equals(e)){break}if(c.isReadOnly()){if(c.getPosition(e)&CKEDITOR.POSITION_CONTAINS){break}c=c.getNext(g);continue}var j=c.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT),h=c.getName()=="img"&&c.data("cke-realelement");if(!h&&f(d,c)){if(o.test(c.getName())){c.remove(1)}else{c.removeAttributes(m);d.fire("removeFormatCleanup",c)}}c=j}}k.moveToBookmark(a)}d.forceNextSelectionCheck();d.getSelection().selectRanges(l)}}},filter:function(a,b){var c=a._.removeFormatFilters||[];for(var d=0;d<c.length;d++){if(c[d](b)===false){return false}}return true}};CKEDITOR.editor.prototype.addRemoveFormatFilter=function(a){if(!this._.removeFormatFilters){this._.removeFormatFilters=[]}this._.removeFormatFilters.push(a)};CKEDITOR.config.removeFormatTags="b,big,cite,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var";CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign";