(function(t){function o(){}t.fn.textext.TextExtAjax=o,t.fn.textext.addPlugin("ajax",o);var a=o.prototype,n="ajax.data.callback",e="ajax.cache.results",s="ajax.loading.delay",i="ajax.loading.message",r="ajax.type.delay",g="setSuggestions",d="showDropdown",u="loading",l={ajax:{typeDelay:.5,loadingMessage:"Loading...",loadingDelay:.5,cacheResults:!1,dataCallback:null}};a.init=function(t){var o=this;o.baseInit(t,l),o.on({getSuggestions:o.onGetSuggestions}),o._suggestions=null},a.load=function(o){var a,e=this,s=e.opts(n)||function(t){return{q:t}};a=t.extend(!0,{data:s(o),success:function(t){e.onComplete(t,o)},error:function(t,a){console.error(a,o)}},e.opts("ajax")),t.ajax(a)},a.onComplete=function(t,o){var a=this,n=t;a.dontShowLoading(),1==a.opts(e)&&(a._suggestions=t,n=a.itemManager().filter(t,o)),a.trigger(g,{result:n})},a.dontShowLoading=function(){this.stopTimer(u)},a.showLoading=function(){var t=this;t.dontShowLoading(),t.startTimer(u,t.opts(s),function(){t.trigger(d,function(o){o.clearItems();var a=o.addDropdownItem(t.opts(i));a.addClass("text-loading")})})},a.onGetSuggestions=function(t,o){var a=this,n=a._suggestions,s=(o||{}).query||"";return n&&a.opts(e)===!0?a.onComplete(n,s):void a.startTimer("ajax",a.opts(r),function(){a.showLoading(),a.load(s)})}})(jQuery);